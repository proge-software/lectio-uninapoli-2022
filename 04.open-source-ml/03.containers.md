# Containers <!-- omit in toc -->

## Contents <!-- omit in toc -->


## OS-level virtualization

OS-level virtualization is an operating system (OS) paradigm in which the kernel allows the existence of multiple isolated user space instances, called `containers` (LXC, Solaris containers, Docker, Podman), `zones` (Solaris containers), `virtual private servers` (OpenVZ), `partitions`, `virtual environments` (VEs), `virtual kernels` (DragonFly BSD), or `jails` (FreeBSD jail or chroot jail).

Such instances may look like real computers from the point of view of programs running in them.
A computer program running on an ordinary operating system can see all resources (connected devices, files and folders, network shares, CPU power, quantifiable hardware capabilities) of that computer.
However, programs running inside of a container can only see the container's contents and devices assigned to the container. 

Linux containers are all based on the virtualization, isolation, and resource management mechanisms provided by the Linux kernel, notably Linux namespaces and cgroups.

### cgroups

cgroups (abbreviated from `control groups`) is a Linux kernel feature that limits, accounts for, and isolates the resource usage (CPU, memory, disk I/O, network, etc.) of a collection of processes.


### Namespaces

Namespaces are a feature of the Linux kernel that partitions kernel resources such that one set of processes sees one set of resources while another set of processes sees a different set of resources. The feature works by having the same namespace for a set of resources and processes, but those namespaces refer to distinct resources.
Resources may exist in multiple spaces.
Examples of such resources are process IDs, hostnames, user IDs, file names, and some names associated with network access, and interprocess communication.

Since kernel version 5.6, there are 8 kinds of namespaces.
Namespace functionality is the same across all kinds: each process is associated with a namespace and can only see or use the resources associated with that namespace, and descendant namespaces where applicable.
This way each process (or process group thereof) can have a unique view on the resources.
Which resource is isolated depends on the kind of namespace that has been created for a given process group. 


- Mount (mnt): Mount namespaces control mount points.
- Process ID (pid): The PID namespace provides processes with an independent set of process IDs (PIDs) from other namespaces
- Network (net): Network namespaces virtualize the network stack
- Interprocess Communication (ipc): IPC namespaces isolate processes from SysV style inter-process communication
- UTS: UTS (UNIX Time-Sharing) namespaces allow a single system to appear to have different host and domain names to different processes
- User ID (user): User namespaces are a feature to provide both privilege isolation and user identification segregation across multiple sets of processes
- Control group (cgroup) Namespace: The cgroup namespace type hides the identity of the control group of which process is a member
- Time Namespace: The time namespace allows processes to see different system times in a way similar to the UTS namespace


## Docker

Docker is a set of platform as a service (PaaS) products that use OS-level virtualization to deliver software in packages called containers.
The software that hosts the containers is called Docker Engine.
It was first started in 2013 and is developed by Docker, Inc.


Docker can package an application and its dependencies in a virtual container that can run on any Linux, Windows, or macOS computer.
This enables the application to run in a variety of locations, such as on-premises, in public or private cloud.
When running on Linux, Docker uses the resource isolation features of the Linux kernel (such as cgroups and kernel namespaces) to allow containers to run within a single Linux instance, avoiding the overhead of starting and maintaining virtual machines.

Because Docker containers are lightweight, a single server or virtual machine can run several containers simultaneously.

The Linux kernel's support for namespaces mostly isolates an application's view of the operating environment, including process trees, network, user IDs and mounted file systems, while the kernel's cgroups provide resource limiting for memory and CPU.

Docker implements a high-level API to provide lightweight containers that run processes in isolation.
Docker containers are standard processes, so it is possible to use kernel features to monitor their execution -- including for example the use of tools like strace to observe and intercede with system calls.


## Demo

## References

- https://en.wikipedia.org/wiki/OS-level_virtualization
- https://en.wikipedia.org/wiki/Cgroups
- https://en.wikipedia.org/wiki/Linux_namespaces


## More Links

- https://www.katacoda.com/
- https://docs.microsoft.com/en-us/learn/modules/intro-to-docker-containers/
- https://docs.microsoft.com/en-us/learn/browse/?terms=containers


## Agenda

<!-- TODO -->